@task(
    name="{{ task.task_name }}",
    description="{{ task.task_name }} - {{ task.task_id }}",
    retries={{ task.retries }},
{% if task.retry_delay_seconds > 0 %}
    retry_delay_seconds={{ task.retry_delay_seconds }},
{% endif %}
    tags=["docker", "{{ detected_pattern }}"],
)
def {{ task.task_id }}(upstream_result: Dict[str, Any] = None) -> Dict[str, Any]:
    """
    Docker task: {{ task.task_name }}
    
    Image: {{ task.image }}
    """
    import subprocess
    
    # Build docker run command
    cmd = [
        'docker', 'run',
        '--rm',
        '-v', f'{HOST_DATA_DIR}:{CONTAINER_DATA_DIR}',
{% if task.networks and task.networks | length > 0 %}
{% for network in task.networks %}
        '--network', '{{ network }}',
{% endfor %}
{% endif %}
    ]
    
    # Environment variables
{% if task.environment %}
{% for key, value in task.environment.items() %}
    cmd.extend(['-e', '{{ key }}={{ value }}'])
{% endfor %}
{% endif %}
    
    # Image
    cmd.append('{{ task.image }}')
    
    # Command
{% if task.command %}
{% if task.command is string %}
    cmd.extend({{ task.command.split() | tojson }})
{% else %}
    cmd.extend({{ task.command | tojson }})
{% endif %}
{% endif %}
    
    # Execute
    result = subprocess.run(
        cmd,
        capture_output=True,
        text=True,
        check=True
    )
    
    return {
        'task_id': '{{ task.task_id }}',
        'status': 'success',
        'stdout': result.stdout,
        'stderr': result.stderr,
        'upstream_result': upstream_result,
    }