# Generated by Dagster Code Generator
# Generation Metadata:
# - Generated on: 2023-10-05
# - Dagster version: 1.5.0
# - Pipeline Name: check_pcd_sftp_folder_pipeline
# - Executor Type: k8s_job_executor
# - IO Manager: fs_io_manager

from dagster import job, op, Out, In, RetryPolicy, k8s_job_executor, in_process_executor, fs_io_manager, resource

@resource
def http_endpoints():
    # Define the HTTP endpoints resource
    pass

@resource
def kubernetes_cluster():
    # Define the Kubernetes cluster resource
    pass

@resource
def email_system():
    # Define the email system resource
    pass

@op(
    name="check_pcd_sftp_folder",
    description="Check PCD SFTP Folder",
    out=Out(bool, description="True if the folder is ready, False otherwise"),
    executor_def=k8s_job_executor,
)
def check_pcd_sftp_folder(context):
    """
    Check the PCD SFTP folder for readiness.
    """
    # Implement the logic to check the SFTP folder
    return True

@op(
    name="check_pcd_shared_folder",
    description="Check PCD Shared Folder",
    out=Out(bool, description="True if the folder is ready, False otherwise"),
    executor_def=k8s_job_executor,
)
def check_pcd_shared_folder(context, sftp_folder_ready: bool):
    """
    Check the PCD shared folder for readiness.
    """
    if not sftp_folder_ready:
        raise ValueError("SFTP folder is not ready")
    # Implement the logic to check the shared folder
    return True

@op(
    name="start_pcd_extract_1",
    description="Start PCD Extract 1",
    out=Out(bool, description="True if the extract is successful, False otherwise"),
    executor_def=in_process_executor,
)
def start_pcd_extract_1(context, shared_folder_ready: bool):
    """
    Start the first PCD extract.
    """
    if not shared_folder_ready:
        raise ValueError("Shared folder is not ready")
    # Implement the logic to start the first extract
    return True

@op(
    name="parallel_http_api_extraction",
    description="Parallel HTTP API Extraction",
    out=Out(bool, description="True if the extraction is successful, False otherwise"),
    executor_def=in_process_executor,
)
def parallel_http_api_extraction(context, extract_1_successful: bool):
    """
    Perform parallel HTTP API extraction.
    """
    if not extract_1_successful:
        raise ValueError("First extract was not successful")
    # Implement the logic to perform parallel HTTP API extraction
    return True

@op(
    name="start_pcd_extract_2",
    description="Start PCD Extract 2",
    out=Out(bool, description="True if the extract is successful, False otherwise"),
    executor_def=in_process_executor,
)
def start_pcd_extract_2(context, parallel_extraction_successful: bool):
    """
    Start the second PCD extract.
    """
    if not parallel_extraction_successful:
        raise ValueError("Parallel extraction was not successful")
    # Implement the logic to start the second extract
    return True

@op(
    name="pcd_file_upload",
    description="PCD File Upload",
    out=Out(bool, description="True if the upload is successful, False otherwise"),
    executor_def=k8s_job_executor,
)
def pcd_file_upload(context, extract_2_successful: bool):
    """
    Upload the PCD file.
    """
    if not extract_2_successful:
        raise ValueError("Second extract was not successful")
    # Implement the logic to upload the PCD file
    return True

@op(
    name="etl_notification",
    description="ETL Notification",
    out=Out(bool, description="True if the notification is successful, False otherwise"),
    executor_def=in_process_executor,
)
def etl_notification(context, file_upload_successful: bool, parallel_extraction_successful: bool):
    """
    Send an ETL notification.
    """
    if not file_upload_successful or not parallel_extraction_successful:
        raise ValueError("File upload or parallel extraction was not successful")
    # Implement the logic to send an ETL notification
    return True

@job(
    name="check_pcd_sftp_folder_pipeline",
    description="No description provided.",
    executor_def=k8s_job_executor,
    resource_defs={
        "http_endpoints": http_endpoints,
        "kubernetes_cluster": kubernetes_cluster,
        "email_system": email_system,
    },
    io_manager_def=fs_io_manager,
)
def check_pcd_sftp_folder_pipeline():
    """
    The main pipeline for checking PCD SFTP and shared folders, performing extracts, and sending notifications.
    """
    sftp_folder_ready = check_pcd_sftp_folder()
    shared_folder_ready = check_pcd_shared_folder(sftp_folder_ready)
    extract_1_successful = start_pcd_extract_1(shared_folder_ready)
    parallel_extraction_successful = parallel_http_api_extraction(extract_1_successful)
    extract_2_successful = start_pcd_extract_2(parallel_extraction_successful)
    file_upload_successful = pcd_file_upload(extract_2_successful)
    etl_notification(file_upload_successful, parallel_extraction_successful)