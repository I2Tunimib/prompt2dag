# Generated by Dagster Code Generator
# Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    resource,
    fs_io_manager,
    Field,
    String,
    Int,
    Bool,
    DagsterType,
    DagsterRunStatus,
    DagsterEvent,
    DagsterEventType,
    DagsterInstance,
    execute_job,
    job_executor_config,
    docker_executor,
)

# Resources
@resource(config_schema={"data_dir": Field(String)})
def data_dir(context):
    """Data Directory Resource"""
    return context.resource_config["data_dir"]

@resource
def load_and_modify_service():
    """Load and Modify Service Resource"""
    pass

@resource
def reconciliation_service():
    """Reconciliation Service Resource"""
    pass

@resource
def openmeteo_service():
    """OpenMeteo Service Resource"""
    pass

@resource
def geoapify_land_use_api():
    """Geoapify Land Use API Resource"""
    pass

@resource
def worldpop_density_api():
    """WorldPop Density API Resource"""
    pass

@resource
def column_extension_service():
    """Column Extension Service Resource"""
    pass

@resource
def save_service():
    """Save Service Resource"""
    pass

@resource
def docker_network():
    """Docker Network Resource"""
    pass

@resource
def mongodb():
    """MongoDB Resource"""
    pass

@resource
def intertwino_api():
    """Intertwino API Resource"""
    pass

# Ops
@op(
    name="load_and_modify_data",
    out={"modified_data": Out()},
    required_resource_keys={"load_and_modify_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def load_and_modify_data(context):
    """Load and modify the initial data."""
    # Example implementation
    modified_data = context.resources.load_and_modify_service.load_and_modify()
    return modified_data

@op(
    name="reconcile_geocoding",
    ins={"modified_data": In()},
    out={"reconciled_data": Out()},
    required_resource_keys={"reconciliation_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def reconcile_geocoding(context, modified_data):
    """Reconcile geocoding data."""
    # Example implementation
    reconciled_data = context.resources.reconciliation_service.reconcile(modified_data)
    return reconciled_data

@op(
    name="extend_openmeteo_data",
    ins={"reconciled_data": In()},
    out={"extended_openmeteo_data": Out()},
    required_resource_keys={"openmeteo_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def extend_openmeteo_data(context, reconciled_data):
    """Extend data with OpenMeteo data."""
    # Example implementation
    extended_openmeteo_data = context.resources.openmeteo_service.extend(reconciled_data)
    return extended_openmeteo_data

@op(
    name="extend_land_use",
    ins={"extended_openmeteo_data": In()},
    out={"extended_land_use_data": Out()},
    required_resource_keys={"geoapify_land_use_api"},
    retry_policy=RetryPolicy(max_retries=1),
)
def extend_land_use(context, extended_openmeteo_data):
    """Extend data with land use information."""
    # Example implementation
    extended_land_use_data = context.resources.geoapify_land_use_api.extend(extended_openmeteo_data)
    return extended_land_use_data

@op(
    name="extend_population_density",
    ins={"extended_land_use_data": In()},
    out={"extended_population_density_data": Out()},
    required_resource_keys={"worldpop_density_api"},
    retry_policy=RetryPolicy(max_retries=1),
)
def extend_population_density(context, extended_land_use_data):
    """Extend data with population density information."""
    # Example implementation
    extended_population_density_data = context.resources.worldpop_density_api.extend(extended_land_use_data)
    return extended_population_density_data

@op(
    name="extend_environmental_risk",
    ins={"extended_population_density_data": In()},
    out={"extended_environmental_risk_data": Out()},
    required_resource_keys={"column_extension_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def extend_environmental_risk(context, extended_population_density_data):
    """Extend data with environmental risk information."""
    # Example implementation
    extended_environmental_risk_data = context.resources.column_extension_service.extend(extended_population_density_data)
    return extended_environmental_risk_data

@op(
    name="save_final_data",
    ins={"extended_environmental_risk_data": In()},
    required_resource_keys={"save_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def save_final_data(context, extended_environmental_risk_data):
    """Save the final data."""
    # Example implementation
    context.resources.save_service.save(extended_environmental_risk_data)

# Job
@job(
    name="load_and_modify_data_pipeline",
    description="Environmental Monitoring Network Pipeline Configuration",
    executor_def=docker_executor,
    resource_defs={
        "data_dir": data_dir,
        "load_and_modify_service": load_and_modify_service,
        "reconciliation_service": reconciliation_service,
        "openmeteo_service": openmeteo_service,
        "geoapify_land_use_api": geoapify_land_use_api,
        "worldpop_density_api": worldpop_density_api,
        "column_extension_service": column_extension_service,
        "save_service": save_service,
        "docker_network": docker_network,
        "mongodb": mongodb,
        "intertwino_api": intertwino_api,
        "io_manager": fs_io_manager,
    },
)
def load_and_modify_data_pipeline():
    modified_data = load_and_modify_data()
    reconciled_data = reconcile_geocoding(modified_data)
    extended_openmeteo_data = extend_openmeteo_data(reconciled_data)
    extended_land_use_data = extend_land_use(extended_openmeteo_data)
    extended_population_density_data = extend_population_density(extended_land_use_data)
    extended_environmental_risk_data = extend_environmental_risk(extended_population_density_data)
    save_final_data(extended_environmental_risk_data)