# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: get_airvisual_data_hourly_pipeline
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: local_filesystem, airvisual_api, postgres_conn

from dagster import job, op, Out, In, RetryPolicy, resource, fs_io_manager, in_process_executor

@resource
def airvisual_api():
    """Resource for interacting with the AirVisual API."""
    # Implementation for AirVisual API interaction
    pass

@resource
def postgres_conn():
    """Resource for connecting to the PostgreSQL database."""
    # Implementation for PostgreSQL connection
    pass

@op(
    name="get_airvisual_data_hourly",
    description="Fetch AirVisual Data",
    out={"airvisual_data": Out()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"airvisual_api"}
)
def get_airvisual_data_hourly(context):
    """Fetch data from the AirVisual API."""
    airvisual_data = context.resources.airvisual_api.fetch_data()
    return airvisual_data

@op(
    name="read_data_airvisual",
    description="Read and Validate AirVisual Data",
    ins={"airvisual_data": In()},
    out={"validated_data": Out()},
    retry_policy=RetryPolicy(max_retries=2)
)
def read_data_airvisual(context, airvisual_data):
    """Read and validate the fetched AirVisual data."""
    validated_data = validate_data(airvisual_data)
    return validated_data

@op(
    name="load_data_airvisual_to_postgresql",
    description="Load AirVisual Data to PostgreSQL",
    ins={"validated_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"postgres_conn"}
)
def load_data_airvisual_to_postgresql(context, validated_data):
    """Load validated AirVisual data into the PostgreSQL database."""
    context.resources.postgres_conn.load_data(validated_data)

@job(
    name="get_airvisual_data_hourly_pipeline",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={
        "airvisual_api": airvisual_api,
        "postgres_conn": postgres_conn,
        "io_manager": fs_io_manager
    }
)
def get_airvisual_data_hourly_pipeline():
    """Dagster job to fetch, validate, and load AirVisual data."""
    load_data_airvisual_to_postgresql(
        read_data_airvisual(
            get_airvisual_data_hourly()
        )
    )

def validate_data(data):
    """Placeholder function to validate data."""
    # Implement data validation logic here
    return data