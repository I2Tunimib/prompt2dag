# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: airvisual_pipeline_lat_long_v1
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: airvisual_api, postgres_conn, local_filesystem

from dagster import job, op, Out, In, RetryPolicy, fs_io_manager, in_process_executor, resource

@resource
def airvisual_api():
    """Resource for AirVisual API."""
    # Implementation for AirVisual API resource
    pass

@resource
def postgres_conn():
    """Resource for PostgreSQL Database connection."""
    # Implementation for PostgreSQL Database connection resource
    pass

@resource
def local_filesystem():
    """Resource for Local Filesystem."""
    # Implementation for Local Filesystem resource
    pass

@op(
    name="get_airvisual_data_hourly",
    out={"airvisual_data": Out()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"airvisual_api"}
)
def fetch_airvisual_data(context):
    """Fetch AirVisual Data."""
    # Fetch data from AirVisual API
    airvisual_data = context.resources.airvisual_api.fetch_data()
    return airvisual_data

@op(
    name="read_data_airvisual",
    ins={"airvisual_data": In()},
    out={"validated_data": Out()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"local_filesystem"}
)
def read_and_validate_airvisual_data(context, airvisual_data):
    """Read and Validate AirVisual Data."""
    # Read and validate data
    validated_data = context.resources.local_filesystem.read_and_validate(airvisual_data)
    return validated_data

@op(
    name="load_data_airvisual_to_postgresql",
    ins={"validated_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"postgres_conn"}
)
def load_airvisual_data_to_postgresql(context, validated_data):
    """Load AirVisual Data to PostgreSQL."""
    # Load data to PostgreSQL
    context.resources.postgres_conn.load_data(validated_data)

@job(
    name="airvisual_pipeline_lat_long_v1",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={
        "airvisual_api": airvisual_api,
        "postgres_conn": postgres_conn,
        "local_filesystem": local_filesystem
    },
    io_manager_def=fs_io_manager
)
def airvisual_pipeline_lat_long_v1():
    """AirVisual Pipeline to fetch, validate, and load data."""
    load_airvisual_data_to_postgresql(
        read_and_validate_airvisual_data(
            fetch_airvisual_data()
        )
    )