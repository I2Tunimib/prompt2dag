# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: load_and_modify_data_pipeline
# - Description: No description provided.
# - Executor Type: docker_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: data_dir

from dagster import job, op, Out, In, RetryPolicy, fs_io_manager, docker_executor, resource

@resource
def load_and_modify_service():
    """Resource for the Load and Modify Service."""
    pass

@resource
def reconciliation_service():
    """Resource for the Reconciliation Service."""
    pass

@resource
def save_service():
    """Resource for the Save Service."""
    pass

@resource
def pymongo_resource():
    """Resource for MongoDB."""
    pass

@resource
def intertwino_api():
    """Resource for the Intertwino API."""
    pass

@op(
    name="load_and_modify_data",
    out={"modified_data": Out()},
    required_resource_keys={"load_and_modify_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def load_and_modify_data(context):
    """Load and modify data using the Load and Modify Service."""
    # Example data loading and modification logic
    data = context.resources.load_and_modify_service.load_data()
    modified_data = context.resources.load_and_modify_service.modify_data(data)
    return modified_data

@op(
    name="entity_reconciliation",
    ins={"modified_data": In()},
    out={"reconciled_data": Out()},
    required_resource_keys={"reconciliation_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def entity_reconciliation(context, modified_data):
    """Perform entity reconciliation using the Reconciliation Service."""
    # Example reconciliation logic
    reconciled_data = context.resources.reconciliation_service.reconcile(modified_data)
    return reconciled_data

@op(
    name="save_final_data",
    ins={"reconciled_data": In()},
    required_resource_keys={"save_service"},
    retry_policy=RetryPolicy(max_retries=1),
)
def save_final_data(context, reconciled_data):
    """Save the final data using the Save Service."""
    # Example data saving logic
    context.resources.save_service.save_data(reconciled_data)

@job(
    name="load_and_modify_data_pipeline",
    description="No description provided.",
    executor_def=docker_executor,
    resource_defs={
        "data_dir": fs_io_manager,
        "load_and_modify_service": load_and_modify_service,
        "reconciliation_service": reconciliation_service,
        "save_service": save_service,
        "mongodb": pymongo_resource,
        "intertwino_api": intertwino_api,
    },
)
def load_and_modify_data_pipeline():
    """Dagster job for loading, modifying, and saving data."""
    modified_data = load_and_modify_data()
    reconciled_data = entity_reconciliation(modified_data)
    save_final_data(reconciled_data)