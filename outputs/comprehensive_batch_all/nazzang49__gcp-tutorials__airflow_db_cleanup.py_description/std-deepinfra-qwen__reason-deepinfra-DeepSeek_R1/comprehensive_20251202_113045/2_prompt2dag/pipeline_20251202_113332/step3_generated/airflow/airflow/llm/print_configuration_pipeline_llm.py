# Generated by Airflow DAG Code Generator
# Date: 2023-10-05
# Author: Airflow Expert
# Description: This DAG is designed to print configuration and clean up the Airflow MetaDB.

from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.utils.dates import days_ago
from airflow.providers.apache.hive.operators.hive import HiveOperator
from airflow.providers.docker.operators.docker import DockerOperator
from airflow.providers.http.operators.http import SimpleHttpOperator
from airflow.providers.rabbitmq.operators.rabbitmq import RabbitMQOperator
from airflow.providers.apache.hive.hooks.hive import HiveServer2Hook
from airflow.providers.http.hooks.http import HttpHook
from airflow.providers.rabbitmq.hooks.rabbitmq import RabbitMQHook
from airflow.models import Variable
from airflow.exceptions import AirflowException
import logging

# Default arguments for the DAG
default_args = {
    'owner': 'airflow',
    'start_date': days_ago(1),
    'retries': 1,
    'retry_delay': timedelta(minutes=5),
}

# Define the DAG
with DAG(
    dag_id='print_configuration_pipeline',
    schedule_interval='@daily',
    default_args=default_args,
    catchup=False,
    tags=['example', 'sequential'],
) as dag:

    # Task: Print Configuration
    def print_configuration():
        logging.info("Printing configuration...")
        # Example of accessing Airflow Variables
        example_var = Variable.get('example_variable', default_var='default_value')
        logging.info(f"Example Variable: {example_var}")
        # Add more configuration printing as needed

    print_configuration_task = PythonOperator(
        task_id='print_configuration',
        python_callable=print_configuration,
        retries=1,
    )

    # Task: Cleanup Airflow MetaDB
    def cleanup_airflow_metadb():
        logging.info("Cleaning up Airflow MetaDB...")
        # Example of using a hook to interact with the Airflow MetaStore
        hook = HiveServer2Hook(hive_cli_conn_id='airflow_metastore')
        hook.run('TRUNCATE TABLE example_table')
        # Add more cleanup logic as needed

    cleanup_airflow_metadb_task = PythonOperator(
        task_id='cleanup_airflow_metadb',
        python_callable=cleanup_airflow_metadb,
        retries=1,
    )

    # Set task dependencies
    print_configuration_task >> cleanup_airflow_metadb_task