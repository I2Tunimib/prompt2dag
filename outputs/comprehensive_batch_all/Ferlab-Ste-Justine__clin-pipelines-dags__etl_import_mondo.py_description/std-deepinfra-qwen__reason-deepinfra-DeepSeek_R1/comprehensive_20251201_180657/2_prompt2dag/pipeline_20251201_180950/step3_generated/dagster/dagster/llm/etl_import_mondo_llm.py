# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: etl_import_mondo
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: es_url, s3_conn_id, internal_validation_system, slack_webhook, github_releases

from dagster import job, op, In, Out, RetryPolicy, ResourceDefinition, fs_io_manager, in_process_executor

# Define resources
github_releases = ResourceDefinition.mock_resource()
s3_datalake = ResourceDefinition.mock_resource()
elasticsearch = ResourceDefinition.mock_resource()
slack_webhook = ResourceDefinition.mock_resource()

@op(
    description="Validate Parameters",
    out={"validated_params": Out(dict, description="Validated parameters")},
    required_resource_keys={"internal_validation_system"},
)
def params_validate(context):
    """Validate the parameters for the ETL process."""
    validated_params = {"param1": "value1", "param2": "value2"}  # Example validation
    context.log.info("Parameters validated successfully")
    return validated_params

@op(
    description="Download Mondo Terms",
    ins={"validated_params": In(dict, description="Validated parameters")},
    out={"mondo_terms": Out(dict, description="Downloaded Mondo terms")},
    required_resource_keys={"github_releases"},
)
def download_mondo_terms(context, validated_params):
    """Download Mondo terms from GitHub releases."""
    mondo_terms = {"term1": "definition1", "term2": "definition2"}  # Example data
    context.log.info("Mondo terms downloaded successfully")
    return mondo_terms

@op(
    description="Normalize Mondo Terms",
    ins={"mondo_terms": In(dict, description="Downloaded Mondo terms")},
    out={"normalized_terms": Out(dict, description="Normalized Mondo terms")},
)
def normalized_mondo_terms(context, mondo_terms):
    """Normalize the downloaded Mondo terms."""
    normalized_terms = {"term1": "normalized1", "term2": "normalized2"}  # Example normalization
    context.log.info("Mondo terms normalized successfully")
    return normalized_terms

@op(
    description="Index Mondo Terms",
    ins={"normalized_terms": In(dict, description="Normalized Mondo terms")},
    out={"indexed_terms": Out(dict, description="Indexed Mondo terms")},
    required_resource_keys={"elasticsearch"},
)
def index_mondo_terms(context, normalized_terms):
    """Index the normalized Mondo terms in Elasticsearch."""
    indexed_terms = {"term1": "indexed1", "term2": "indexed2"}  # Example indexing
    context.log.info("Mondo terms indexed successfully")
    return indexed_terms

@op(
    description="Publish Mondo Data",
    ins={"indexed_terms": In(dict, description="Indexed Mondo terms")},
    out={"published_data": Out(dict, description="Published Mondo data")},
    required_resource_keys={"s3_datalake"},
)
def publish_mondo(context, indexed_terms):
    """Publish the indexed Mondo data to the S3 Data Lake."""
    published_data = {"term1": "published1", "term2": "published2"}  # Example publishing
    context.log.info("Mondo data published successfully")
    return published_data

@op(
    description="Send Slack Notification",
    ins={"published_data": In(dict, description="Published Mondo data")},
    required_resource_keys={"slack_webhook"},
)
def slack(context, published_data):
    """Send a Slack notification about the completion of the ETL process."""
    context.log.info("Slack notification sent successfully")

@job(
    name="etl_import_mondo",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={
        "github_releases": github_releases,
        "s3_datalake": s3_datalake,
        "elasticsearch": elasticsearch,
        "slack_webhook": slack_webhook,
        "internal_validation_system": ResourceDefinition.mock_resource(),
    },
    io_manager_def=fs_io_manager,
)
def etl_import_mondo():
    """ETL pipeline to import Mondo data."""
    validated_params = params_validate()
    mondo_terms = download_mondo_terms(validated_params)
    normalized_terms = normalized_mondo_terms(mondo_terms)
    indexed_terms = index_mondo_terms(normalized_terms)
    published_data = publish_mondo(indexed_terms)
    slack(published_data)