# Generated by Dagster Code Generator
# Generation Metadata
# - Job Name: get_data_mahidol_aqi_report_pipeline
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: postgres_conn, smtp_conn, mahidol_aqi_website

from dagster import job, op, Out, In, RetryPolicy, resource, fs_io_manager, InProcessExecutor, ExecutorDefinition

@resource
def mahidol_aqi_website():
    """Resource for accessing Mahidol University AQI Website."""
    pass

@resource
def postgres_data_warehouse():
    """Resource for accessing PostgreSQL Data Warehouse."""
    pass

@resource
def smtp_server():
    """Resource for accessing SMTP Server."""
    pass

@resource
def config_filesystem():
    """Resource for accessing Configuration Filesystem."""
    pass

@op(
    required_resource_keys={"mahidol_aqi_website"},
    out={"aqi_data": Out(str, description="Scraped AQI data from Mahidol University website.")}
)
def get_data_mahidol_aqi_report(context):
    """Scrape Mahidol AQI Report."""
    # Placeholder for actual scraping logic
    aqi_data = "Sample AQI Data"
    context.log.info(f"Scraped AQI data: {aqi_data}")
    return aqi_data

@op(
    ins={"aqi_data": In(str, description="Scraped AQI data from Mahidol University website.")},
    out={"json_data": Out(dict, description="Parsed and validated AQI data as JSON object.")}
)
def create_json_object(context, aqi_data):
    """Parse and Validate AQI Data."""
    # Placeholder for actual parsing and validation logic
    json_data = {"aqi": 50, "location": "Mahidol University"}
    context.log.info(f"Parsed and validated AQI data: {json_data}")
    return json_data

@op(
    required_resource_keys={"postgres_data_warehouse"},
    ins={"json_data": In(dict, description="Parsed and validated AQI data as JSON object.")}
)
def load_mahidol_aqi_to_postgres(context, json_data):
    """Load AQI Data to PostgreSQL."""
    # Placeholder for actual loading logic
    context.log.info(f"Loaded AQI data to PostgreSQL: {json_data}")

@op(
    required_resource_keys={"smtp_server"},
    ins={"json_data": In(dict, description="Parsed and validated AQI data as JSON object.")}
)
def alert_email(context, json_data):
    """Send AQI Alert Emails."""
    # Placeholder for actual email sending logic
    context.log.info(f"Sent AQI alert email: {json_data}")

@job(
    name="get_data_mahidol_aqi_report_pipeline",
    description="No description provided.",
    executor_def=InProcessExecutor(),
    resource_defs={
        "mahidol_aqi_website": mahidol_aqi_website,
        "postgres_data_warehouse": postgres_data_warehouse,
        "smtp_server": smtp_server,
        "io_manager": fs_io_manager,
        "config_filesystem": config_filesystem
    }
)
def get_data_mahidol_aqi_report_pipeline():
    json_data = create_json_object(get_data_mahidol_aqi_report())
    alert_email(load_mahidol_aqi_to_postgres(json_data))