# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: get_data_mahidol_aqi_report_pipeline
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: http_mahidol, postgres_conn, smtp_conn

from dagster import job, op, Out, In, RetryPolicy, fs_io_manager, resource, in_process_executor

@resource
def mahidol_aqi_website():
    """Resource for accessing the Mahidol University AQI Website."""
    pass

@resource
def local_filesystem():
    """Resource for the local filesystem."""
    pass

@resource
def postgres_conn():
    """Resource for the PostgreSQL connection."""
    pass

@resource
def smtp_server():
    """Resource for the SMTP server."""
    pass

@resource
def config_filesystem():
    """Resource for the configuration filesystem."""
    pass

@op(
    name="get_data_mahidol_aqi_report",
    description="Fetches the AQI report from the Mahidol University website.",
    out=Out(dict, description="AQI report data"),
    required_resource_keys={"mahidol_aqi_website"},
)
def get_data_mahidol_aqi_report(context):
    """Fetches the AQI report from the Mahidol University website."""
    # Placeholder for actual data fetching logic
    aqi_report = {"data": "sample_data"}
    return aqi_report

@op(
    name="create_json_object",
    description="Creates a JSON object from the AQI report data.",
    ins={"aqi_report": In(dict, description="AQI report data")},
    out=Out(str, description="JSON object of the AQI report"),
)
def create_json_object(context, aqi_report):
    """Creates a JSON object from the AQI report data."""
    import json
    json_object = json.dumps(aqi_report)
    return json_object

@op(
    name="load_mahidol_aqi_to_postgres",
    description="Loads the AQI report data into the PostgreSQL database.",
    ins={"json_object": In(str, description="JSON object of the AQI report")},
    required_resource_keys={"postgres_conn"},
)
def load_mahidol_aqi_to_postgres(context, json_object):
    """Loads the AQI report data into the PostgreSQL database."""
    # Placeholder for actual data loading logic
    context.log.info(f"Loading JSON object into PostgreSQL: {json_object}")

@op(
    name="alert_email",
    description="Sends an email alert with the AQI report data.",
    required_resource_keys={"smtp_server"},
)
def alert_email(context):
    """Sends an email alert with the AQI report data."""
    # Placeholder for actual email sending logic
    context.log.info("Sending email alert with AQI report data")

@job(
    name="get_data_mahidol_aqi_report_pipeline",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={
        "mahidol_aqi_website": mahidol_aqi_website,
        "local_filesystem": local_filesystem,
        "postgres_conn": postgres_conn,
        "smtp_server": smtp_server,
        "config_filesystem": config_filesystem,
    },
    config={
        "ops": {
            "get_data_mahidol_aqi_report": {
                "config": {}
            },
            "create_json_object": {
                "config": {}
            },
            "load_mahidol_aqi_to_postgres": {
                "config": {}
            },
            "alert_email": {
                "config": {}
            }
        }
    }
)
def get_data_mahidol_aqi_report_pipeline():
    """Dagster job for fetching and processing AQI report data from Mahidol University."""
    aqi_report = get_data_mahidol_aqi_report()
    json_object = create_json_object(aqi_report)
    load_mahidol_aqi_to_postgres(json_object)
    alert_email()