# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: create_customer_pipeline
# - Description: No description provided.
# - Executor Type: in_process_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: ["magento_default"]

from dagster import job, op, In, Out, RetryPolicy, ResourceDefinition, fs_io_manager, in_process_executor

# Define the required resource for the Magento GraphQL API
magento_default = ResourceDefinition.mock_resource()

@op(
    name="create_customer",
    description="Create a new customer in the Magento system.",
    out=Out(str, description="The ID of the newly created customer."),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1)
)
def create_customer(context):
    """
    Create a new customer in the Magento system.

    Args:
        context (OpExecutionContext): The execution context for the op.

    Returns:
        str: The ID of the newly created customer.
    """
    # Example implementation (replace with actual logic)
    customer_id = "12345"
    context.log.info(f"Created customer with ID: {customer_id}")
    return customer_id

@op(
    name="generate_customer_token",
    description="Generate a token for the newly created customer.",
    ins={"customer_id": In(str, description="The ID of the customer to generate a token for.")},
    out=Out(str, description="The generated customer token."),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1)
)
def generate_customer_token(context, customer_id):
    """
    Generate a token for the newly created customer.

    Args:
        context (OpExecutionContext): The execution context for the op.
        customer_id (str): The ID of the customer to generate a token for.

    Returns:
        str: The generated customer token.
    """
    # Example implementation (replace with actual logic)
    token = "abc123"
    context.log.info(f"Generated token for customer ID: {customer_id}, Token: {token}")
    return token

@op(
    name="get_customer_info",
    description="Retrieve detailed information about the customer.",
    ins={"customer_token": In(str, description="The token of the customer to retrieve information for.")},
    out=Out(dict, description="The detailed information about the customer."),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1)
)
def get_customer_info(context, customer_token):
    """
    Retrieve detailed information about the customer.

    Args:
        context (OpExecutionContext): The execution context for the op.
        customer_token (str): The token of the customer to retrieve information for.

    Returns:
        dict: The detailed information about the customer.
    """
    # Example implementation (replace with actual logic)
    customer_info = {
        "id": "12345",
        "name": "John Doe",
        "email": "john.doe@example.com"
    }
    context.log.info(f"Retrieved customer info for token: {customer_token}, Info: {customer_info}")
    return customer_info

@job(
    name="create_customer_pipeline",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={"magento_default": magento_default, "io_manager": fs_io_manager}
)
def create_customer_pipeline():
    """
    A Dagster job to create a customer, generate a token, and retrieve customer information.
    """
    customer_id = create_customer()
    customer_token = generate_customer_token(customer_id)
    get_customer_info(customer_token)