# Generated by Dagster Code Generator
# Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import job, op, In, Out, RetryPolicy, ResourceDefinition, fs_io_manager, in_process_executor

# Define the required resources
magento_default = ResourceDefinition.mock_resource()


@op(
    name="create_customer",
    description="Create a new customer",
    out=Out(str, description="Customer ID"),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1),
)
def create_customer(context):
    """
    Create a new customer using the Magento GraphQL API.
    """
    # Example implementation
    customer_id = context.resources.magento_default.create_customer()
    return customer_id


@op(
    name="generate_customer_token",
    description="Generate a token for the customer",
    ins={"customer_id": In(str, description="Customer ID")},
    out=Out(str, description="Customer Token"),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1),
)
def generate_customer_token(context, customer_id):
    """
    Generate a token for the customer using the Magento GraphQL API.
    """
    # Example implementation
    customer_token = context.resources.magento_default.generate_customer_token(customer_id)
    return customer_token


@op(
    name="get_customer_info",
    description="Get detailed information about the customer",
    ins={"customer_token": In(str, description="Customer Token")},
    out=Out(dict, description="Customer Information"),
    required_resource_keys={"magento_default"},
    retry_policy=RetryPolicy(max_retries=1),
)
def get_customer_info(context, customer_token):
    """
    Get detailed information about the customer using the Magento GraphQL API.
    """
    # Example implementation
    customer_info = context.resources.magento_default.get_customer_info(customer_token)
    return customer_info


@job(
    name="create_customer_pipeline",
    description="No description provided.",
    executor_def=in_process_executor,
    resource_defs={"magento_default": magento_default, "io_manager": fs_io_manager},
)
def create_customer_pipeline():
    """
    A sequential pipeline to create a customer, generate a token, and get customer information.
    """
    customer_id = create_customer()
    customer_token = generate_customer_token(customer_id)
    get_customer_info(customer_token)