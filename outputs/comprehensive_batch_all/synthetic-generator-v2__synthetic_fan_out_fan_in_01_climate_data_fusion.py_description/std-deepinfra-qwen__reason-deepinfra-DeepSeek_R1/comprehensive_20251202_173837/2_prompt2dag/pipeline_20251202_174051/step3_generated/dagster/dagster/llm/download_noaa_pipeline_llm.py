# Generated by Dagster Code Generator
# Date: 2023-10-06
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    schedule,
)

# Resources
@resource
def ftp_noaa():
    """NOAA FTP Server resource."""
    pass

@resource
def https_ecmwf():
    """ECMWF HTTPS Endpoint resource."""
    pass

@resource
def https_jma():
    """JMA HTTPS Endpoint resource."""
    pass

@resource
def https_metoffice():
    """MetOffice HTTPS Endpoint resource."""
    pass

@resource
def https_bom():
    """BOM HTTPS Endpoint resource."""
    pass

@resource
def xcom():
    """XCom Data Passing resource."""
    pass

# Ops
@op(
    required_resource_keys={"https_bom"},
    out={"bom_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def download_bom(context):
    """Download BOM Data."""
    # Placeholder for actual download logic
    bom_data = "BOM Data"
    return bom_data

@op(
    required_resource_keys={"https_ecmwf"},
    out={"ecmwf_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def download_ecmwf(context):
    """Download ECMWF Data."""
    # Placeholder for actual download logic
    ecmwf_data = "ECMWF Data"
    return ecmwf_data

@op(
    required_resource_keys={"https_jma"},
    out={"jma_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def download_jma(context):
    """Download JMA Data."""
    # Placeholder for actual download logic
    jma_data = "JMA Data"
    return jma_data

@op(
    required_resource_keys={"https_metoffice"},
    out={"metoffice_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def download_metoffice(context):
    """Download MetOffice Data."""
    # Placeholder for actual download logic
    metoffice_data = "MetOffice Data"
    return metoffice_data

@op(
    required_resource_keys={"ftp_noaa"},
    out={"noaa_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def download_noaa(context):
    """Download NOAA Data."""
    # Placeholder for actual download logic
    noaa_data = "NOAA Data"
    return noaa_data

@op(
    required_resource_keys={"xcom"},
    out={"normalized_bom_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_bom(context, bom_data):
    """Normalize BOM Data."""
    # Placeholder for actual normalization logic
    normalized_bom_data = "Normalized BOM Data"
    return normalized_bom_data

@op(
    required_resource_keys={"xcom"},
    out={"normalized_ecmwf_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_ecmwf(context, ecmwf_data):
    """Normalize ECMWF Data."""
    # Placeholder for actual normalization logic
    normalized_ecmwf_data = "Normalized ECMWF Data"
    return normalized_ecmwf_data

@op(
    required_resource_keys={"xcom"},
    out={"normalized_jma_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_jma(context, jma_data):
    """Normalize JMA Data."""
    # Placeholder for actual normalization logic
    normalized_jma_data = "Normalized JMA Data"
    return normalized_jma_data

@op(
    required_resource_keys={"xcom"},
    out={"normalized_metoffice_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_metoffice(context, metoffice_data):
    """Normalize MetOffice Data."""
    # Placeholder for actual normalization logic
    normalized_metoffice_data = "Normalized MetOffice Data"
    return normalized_metoffice_data

@op(
    required_resource_keys={"xcom"},
    out={"normalized_noaa_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_noaa(context, noaa_data):
    """Normalize NOAA Data."""
    # Placeholder for actual normalization logic
    normalized_noaa_data = "Normalized NOAA Data"
    return normalized_noaa_data

@op(
    required_resource_keys={"xcom", "output_parquet"},
    out={"merged_data": Out()},
    retry_policy=RetryPolicy(max_retries=3),
)
def merge_climate_data(
    context,
    normalized_bom_data,
    normalized_ecmwf_data,
    normalized_jma_data,
    normalized_metoffice_data,
    normalized_noaa_data,
):
    """Merge Climate Data."""
    # Placeholder for actual merge logic
    merged_data = "Merged Climate Data"
    return merged_data

# Job
@job(
    name="download_noaa_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "ftp_noaa": ftp_noaa,
        "https_ecmwf": https_ecmwf,
        "https_jma": https_jma,
        "https_metoffice": https_metoffice,
        "https_bom": https_bom,
        "xcom": xcom,
        "output_parquet": fs_io_manager,
    },
)
def download_noaa_pipeline():
    """No description provided."""
    bom_data = download_bom()
    ecmwf_data = download_ecmwf()
    jma_data = download_jma()
    metoffice_data = download_metoffice()
    noaa_data = download_noaa()

    normalized_bom_data = normalize_bom(bom_data)
    normalized_ecmwf_data = normalize_ecmwf(ecmwf_data)
    normalized_jma_data = normalize_jma(jma_data)
    normalized_metoffice_data = normalize_metoffice(metoffice_data)
    normalized_noaa_data = normalize_noaa(noaa_data)

    merge_climate_data(
        normalized_bom_data,
        normalized_ecmwf_data,
        normalized_jma_data,
        normalized_metoffice_data,
        normalized_noaa_data,
    )

# Schedule
@schedule(
    job=download_noaa_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="download_noaa_pipeline_schedule",
    catchup=False,
)
def download_noaa_pipeline_schedule(_context):
    return {}