# Generated by Dagster Code Generator
# Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    In,
    Out,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    ScheduleDefinition,
    ScheduleEvaluationContext,
)

@resource
def ftp_noaa():
    """Resource for NOAA FTP Server."""
    pass

@resource
def https_ecmwf():
    """Resource for ECMWF HTTPS Endpoint."""
    pass

@resource
def https_jma():
    """Resource for JMA HTTPS Endpoint."""
    pass

@resource
def https_metoffice():
    """Resource for MetOffice HTTPS Endpoint."""
    pass

@resource
def https_bom():
    """Resource for BOM HTTPS Endpoint."""
    pass

@resource
def xcom():
    """Resource for XCom Data Passing."""
    pass

@resource
def parquet_output():
    """Resource for Parquet Output."""
    pass

@op(
    name="download_bom",
    description="Download BOM Data",
    required_resource_keys={"https_bom"},
    out=Out(str, description="Path to the downloaded BOM data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_bom(context):
    """Download BOM Data."""
    # Placeholder for actual download logic
    return "path/to/bom_data.parquet"

@op(
    name="download_ecmwf",
    description="Download ECMWF Data",
    required_resource_keys={"https_ecmwf"},
    out=Out(str, description="Path to the downloaded ECMWF data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_ecmwf(context):
    """Download ECMWF Data."""
    # Placeholder for actual download logic
    return "path/to/ecmwf_data.parquet"

@op(
    name="download_jma",
    description="Download JMA Data",
    required_resource_keys={"https_jma"},
    out=Out(str, description="Path to the downloaded JMA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_jma(context):
    """Download JMA Data."""
    # Placeholder for actual download logic
    return "path/to/jma_data.parquet"

@op(
    name="download_metoffice",
    description="Download MetOffice Data",
    required_resource_keys={"https_metoffice"},
    out=Out(str, description="Path to the downloaded MetOffice data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_metoffice(context):
    """Download MetOffice Data."""
    # Placeholder for actual download logic
    return "path/to/metoffice_data.parquet"

@op(
    name="download_noaa",
    description="Download NOAA Data",
    required_resource_keys={"ftp_noaa"},
    out=Out(str, description="Path to the downloaded NOAA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_noaa(context):
    """Download NOAA Data."""
    # Placeholder for actual download logic
    return "path/to/noaa_data.parquet"

@op(
    name="normalize_bom",
    description="Normalize BOM Data",
    ins={"bom_data_path": In(str, description="Path to the BOM data")},
    out=Out(str, description="Path to the normalized BOM data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_bom(context, bom_data_path):
    """Normalize BOM Data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized_bom_data.parquet"

@op(
    name="normalize_ecmwf",
    description="Normalize ECMWF Data",
    ins={"ecmwf_data_path": In(str, description="Path to the ECMWF data")},
    out=Out(str, description="Path to the normalized ECMWF data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_ecmwf(context, ecmwf_data_path):
    """Normalize ECMWF Data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized_ecmwf_data.parquet"

@op(
    name="normalize_jma",
    description="Normalize JMA Data",
    ins={"jma_data_path": In(str, description="Path to the JMA data")},
    out=Out(str, description="Path to the normalized JMA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_jma(context, jma_data_path):
    """Normalize JMA Data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized_jma_data.parquet"

@op(
    name="normalize_metoffice",
    description="Normalize MetOffice Data",
    ins={"metoffice_data_path": In(str, description="Path to the MetOffice data")},
    out=Out(str, description="Path to the normalized MetOffice data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_metoffice(context, metoffice_data_path):
    """Normalize MetOffice Data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized_metoffice_data.parquet"

@op(
    name="normalize_noaa",
    description="Normalize NOAA Data",
    ins={"noaa_data_path": In(str, description="Path to the NOAA data")},
    out=Out(str, description="Path to the normalized NOAA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_noaa(context, noaa_data_path):
    """Normalize NOAA Data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized_noaa_data.parquet"

@op(
    name="merge_climate_data",
    description="Merge Climate Data",
    ins={
        "normalized_bom_data_path": In(str, description="Path to the normalized BOM data"),
        "normalized_ecmwf_data_path": In(str, description="Path to the normalized ECMWF data"),
        "normalized_jma_data_path": In(str, description="Path to the normalized JMA data"),
        "normalized_metoffice_data_path": In(str, description="Path to the normalized MetOffice data"),
        "normalized_noaa_data_path": In(str, description="Path to the normalized NOAA data"),
    },
    out=Out(str, description="Path to the merged climate data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def merge_climate_data(
    context,
    normalized_bom_data_path,
    normalized_ecmwf_data_path,
    normalized_jma_data_path,
    normalized_metoffice_data_path,
    normalized_noaa_data_path,
):
    """Merge Climate Data."""
    # Placeholder for actual merge logic
    return "path/to/merged_climate_data.parquet"

@job(
    name="download_noaa_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "ftp_noaa": ftp_noaa,
        "https_ecmwf": https_ecmwf,
        "https_jma": https_jma,
        "https_metoffice": https_metoffice,
        "https_bom": https_bom,
        "xcom": xcom,
        "parquet_output": parquet_output,
    },
    config={
        "execution": {
            "multiprocess": {
                "config": {
                    "max_concurrent": 4,
                }
            }
        },
        "resources": {
            "ftp_noaa": {"config": {}},
            "https_ecmwf": {"config": {}},
            "https_jma": {"config": {}},
            "https_metoffice": {"config": {}},
            "https_bom": {"config": {}},
            "xcom": {"config": {}},
            "parquet_output": {"config": {}},
        },
    },
)
def download_noaa_pipeline():
    """No description provided."""
    bom_data_path = download_bom()
    ecmwf_data_path = download_ecmwf()
    jma_data_path = download_jma()
    metoffice_data_path = download_metoffice()
    noaa_data_path = download_noaa()

    normalized_bom_data_path = normalize_bom(bom_data_path)
    normalized_ecmwf_data_path = normalize_ecmwf(ecmwf_data_path)
    normalized_jma_data_path = normalize_jma(jma_data_path)
    normalized_metoffice_data_path = normalize_metoffice(metoffice_data_path)
    normalized_noaa_data_path = normalize_noaa(noaa_data_path)

    merge_climate_data(
        normalized_bom_data_path,
        normalized_ecmwf_data_path,
        normalized_jma_data_path,
        normalized_metoffice_data_path,
        normalized_noaa_data_path,
    )

# Define the schedule
download_noaa_pipeline_schedule = ScheduleDefinition(
    name="download_noaa_pipeline_schedule",
    cron_schedule="@daily",
    job=download_noaa_pipeline,
    execution_timezone="UTC",
    should_execute=lambda _context: True,
    execution_time_window=None,
    tags=None,
    description="No description provided.",
    default_status=ScheduleDefinition.DEFAULT_STATUS_RUNNING,
)