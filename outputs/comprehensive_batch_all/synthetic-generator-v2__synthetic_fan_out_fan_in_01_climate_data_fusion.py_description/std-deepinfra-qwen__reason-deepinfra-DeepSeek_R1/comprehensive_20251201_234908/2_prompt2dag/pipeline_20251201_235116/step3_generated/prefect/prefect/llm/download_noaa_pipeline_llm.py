# Generated by Prefect 2.x Code Generator
# Date: 2023-10-05
# Prefect Version: 2.14.0

from prefect import flow, task, get_run_logger
from prefect.deployments import Deployment
from prefect.orion.schemas.schedules import CronSchedule
from prefect.infrastructure.docker import DockerContainer
from prefect.tasks import task_input_hash
from prefect.blocks.system import Secret
from prefect.task_runners import ConcurrentTaskRunner

# Secrets
ftp_noaa = Secret.load("ftp_noaa")
https_ecmwf = Secret.load("https_ecmwf")
https_jma = Secret.load("https_jma")
https_metoffice = Secret.load("https_metoffice")
https_bom = Secret.load("https_bom")
xcom = Secret.load("xcom")

@task(retries=3, retry_delay_seconds=10)
def download_bom():
    """Download BOM Data"""
    logger = get_run_logger()
    logger.info("Downloading BOM Data")
    # Placeholder for actual download logic
    return "bom_data"

@task(retries=3, retry_delay_seconds=10)
def download_ecmwf():
    """Download ECMWF Data"""
    logger = get_run_logger()
    logger.info("Downloading ECMWF Data")
    # Placeholder for actual download logic
    return "ecmwf_data"

@task(retries=3, retry_delay_seconds=10)
def download_jma():
    """Download JMA Data"""
    logger = get_run_logger()
    logger.info("Downloading JMA Data")
    # Placeholder for actual download logic
    return "jma_data"

@task(retries=3, retry_delay_seconds=10)
def download_metoffice():
    """Download MetOffice Data"""
    logger = get_run_logger()
    logger.info("Downloading MetOffice Data")
    # Placeholder for actual download logic
    return "metoffice_data"

@task(retries=3, retry_delay_seconds=10)
def download_noaa():
    """Download NOAA Data"""
    logger = get_run_logger()
    logger.info("Downloading NOAA Data")
    # Placeholder for actual download logic
    return "noaa_data"

@task(retries=3, retry_delay_seconds=10)
def normalize_bom(data):
    """Normalize BOM Data"""
    logger = get_run_logger()
    logger.info("Normalizing BOM Data")
    # Placeholder for actual normalization logic
    return "normalized_bom_data"

@task(retries=3, retry_delay_seconds=10)
def normalize_ecmwf(data):
    """Normalize ECMWF Data"""
    logger = get_run_logger()
    logger.info("Normalizing ECMWF Data")
    # Placeholder for actual normalization logic
    return "normalized_ecmwf_data"

@task(retries=3, retry_delay_seconds=10)
def normalize_jma(data):
    """Normalize JMA Data"""
    logger = get_run_logger()
    logger.info("Normalizing JMA Data")
    # Placeholder for actual normalization logic
    return "normalized_jma_data"

@task(retries=3, retry_delay_seconds=10)
def normalize_metoffice(data):
    """Normalize MetOffice Data"""
    logger = get_run_logger()
    logger.info("Normalizing MetOffice Data")
    # Placeholder for actual normalization logic
    return "normalized_metoffice_data"

@task(retries=3, retry_delay_seconds=10)
def normalize_noaa(data):
    """Normalize NOAA Data"""
    logger = get_run_logger()
    logger.info("Normalizing NOAA Data")
    # Placeholder for actual normalization logic
    return "normalized_noaa_data"

@task(retries=3, retry_delay_seconds=10)
def merge_climate_data(*data):
    """Merge Climate Data"""
    logger = get_run_logger()
    logger.info("Merging Climate Data")
    # Placeholder for actual merging logic
    return "merged_climate_data"

@flow(name="download_noaa_pipeline", task_runner=ConcurrentTaskRunner())
def download_noaa_pipeline():
    """No description provided."""
    bom_data = download_bom()
    ecmwf_data = download_ecmwf()
    jma_data = download_jma()
    metoffice_data = download_metoffice()
    noaa_data = download_noaa()

    normalized_bom_data = normalize_bom(bom_data)
    normalized_ecmwf_data = normalize_ecmwf(ecmwf_data)
    normalized_jma_data = normalize_jma(jma_data)
    normalized_metoffice_data = normalize_metoffice(metoffice_data)
    normalized_noaa_data = normalize_noaa(noaa_data)

    merge_climate_data(normalized_bom_data, normalized_ecmwf_data, normalized_jma_data, normalized_metoffice_data, normalized_noaa_data)

# Deployment configuration
deployment = Deployment.build_from_flow(
    flow=download_noaa_pipeline,
    name="download_noaa_pipeline_deployment",
    work_pool_name="default-agent-pool",
    schedule=CronSchedule(cron="0 0 * * *", timezone="UTC", catchup=False),
)

if __name__ == "__main__":
    deployment.apply()