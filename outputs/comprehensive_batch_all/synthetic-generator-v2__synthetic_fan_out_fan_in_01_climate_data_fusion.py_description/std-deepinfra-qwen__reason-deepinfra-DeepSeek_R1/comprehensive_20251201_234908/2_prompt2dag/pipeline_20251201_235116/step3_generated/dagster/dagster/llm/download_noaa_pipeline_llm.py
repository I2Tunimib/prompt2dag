# Generated by Dagster Code Generator
# Generation Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    schedule,
)

# Resources
@resource
def ftp_noaa():
    """Resource for NOAA FTP Server."""
    pass

@resource
def https_ecmwf():
    """Resource for ECMWF HTTPS Endpoint."""
    pass

@resource
def https_jma():
    """Resource for JMA HTTPS Endpoint."""
    pass

@resource
def https_metoffice():
    """Resource for MetOffice HTTPS Endpoint."""
    pass

@resource
def https_bom():
    """Resource for BOM HTTPS Endpoint."""
    pass

@resource
def xcom():
    """Resource for XCom Data Passing."""
    pass

# Tasks
@op(
    name="download_bom",
    description="Download BOM Data",
    required_resource_keys={"https_bom"},
    out=Out(str, description="Path to the downloaded BOM data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_bom(context):
    """Download BOM data from the BOM HTTPS endpoint."""
    # Placeholder for actual download logic
    return "path/to/bom/data"

@op(
    name="download_ecmwf",
    description="Download ECMWF Data",
    required_resource_keys={"https_ecmwf"},
    out=Out(str, description="Path to the downloaded ECMWF data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_ecmwf(context):
    """Download ECMWF data from the ECMWF HTTPS endpoint."""
    # Placeholder for actual download logic
    return "path/to/ecmwf/data"

@op(
    name="download_jma",
    description="Download JMA Data",
    required_resource_keys={"https_jma"},
    out=Out(str, description="Path to the downloaded JMA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_jma(context):
    """Download JMA data from the JMA HTTPS endpoint."""
    # Placeholder for actual download logic
    return "path/to/jma/data"

@op(
    name="download_metoffice",
    description="Download MetOffice Data",
    required_resource_keys={"https_metoffice"},
    out=Out(str, description="Path to the downloaded MetOffice data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_metoffice(context):
    """Download MetOffice data from the MetOffice HTTPS endpoint."""
    # Placeholder for actual download logic
    return "path/to/metoffice/data"

@op(
    name="download_noaa",
    description="Download NOAA Data",
    required_resource_keys={"ftp_noaa"},
    out=Out(str, description="Path to the downloaded NOAA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def download_noaa(context):
    """Download NOAA data from the NOAA FTP server."""
    # Placeholder for actual download logic
    return "path/to/noaa/data"

@op(
    name="normalize_bom",
    description="Normalize BOM Data",
    ins={"bom_data_path": In(str, description="Path to the BOM data")},
    out=Out(str, description="Path to the normalized BOM data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_bom(context, bom_data_path):
    """Normalize BOM data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized/bom/data"

@op(
    name="normalize_ecmwf",
    description="Normalize ECMWF Data",
    ins={"ecmwf_data_path": In(str, description="Path to the ECMWF data")},
    out=Out(str, description="Path to the normalized ECMWF data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_ecmwf(context, ecmwf_data_path):
    """Normalize ECMWF data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized/ecmwf/data"

@op(
    name="normalize_jma",
    description="Normalize JMA Data",
    ins={"jma_data_path": In(str, description="Path to the JMA data")},
    out=Out(str, description="Path to the normalized JMA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_jma(context, jma_data_path):
    """Normalize JMA data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized/jma/data"

@op(
    name="normalize_metoffice",
    description="Normalize MetOffice Data",
    ins={"metoffice_data_path": In(str, description="Path to the MetOffice data")},
    out=Out(str, description="Path to the normalized MetOffice data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_metoffice(context, metoffice_data_path):
    """Normalize MetOffice data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized/metoffice/data"

@op(
    name="normalize_noaa",
    description="Normalize NOAA Data",
    ins={"noaa_data_path": In(str, description="Path to the NOAA data")},
    out=Out(str, description="Path to the normalized NOAA data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def normalize_noaa(context, noaa_data_path):
    """Normalize NOAA data."""
    # Placeholder for actual normalization logic
    return "path/to/normalized/noaa/data"

@op(
    name="merge_climate_data",
    description="Merge Climate Data",
    ins={
        "normalized_bom_data_path": In(str, description="Path to the normalized BOM data"),
        "normalized_ecmwf_data_path": In(str, description="Path to the normalized ECMWF data"),
        "normalized_jma_data_path": In(str, description="Path to the normalized JMA data"),
        "normalized_metoffice_data_path": In(str, description="Path to the normalized MetOffice data"),
        "normalized_noaa_data_path": In(str, description="Path to the normalized NOAA data"),
    },
    out=Out(str, description="Path to the merged climate data"),
    retry_policy=RetryPolicy(max_retries=3),
)
def merge_climate_data(
    context,
    normalized_bom_data_path,
    normalized_ecmwf_data_path,
    normalized_jma_data_path,
    normalized_metoffice_data_path,
    normalized_noaa_data_path,
):
    """Merge normalized climate data from all sources."""
    # Placeholder for actual merge logic
    return "path/to/merged/climate/data"

# Job
@job(
    name="download_noaa_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "ftp_noaa": ftp_noaa,
        "https_ecmwf": https_ecmwf,
        "https_jma": https_jma,
        "https_metoffice": https_metoffice,
        "https_bom": https_bom,
        "xcom": xcom,
    },
    io_manager_def=fs_io_manager,
)
def download_noaa_pipeline():
    """Dagster job to download, normalize, and merge climate data from multiple sources."""
    bom_data_path = download_bom()
    ecmwf_data_path = download_ecmwf()
    jma_data_path = download_jma()
    metoffice_data_path = download_metoffice()
    noaa_data_path = download_noaa()

    normalized_bom_data_path = normalize_bom(bom_data_path)
    normalized_ecmwf_data_path = normalize_ecmwf(ecmwf_data_path)
    normalized_jma_data_path = normalize_jma(jma_data_path)
    normalized_metoffice_data_path = normalize_metoffice(metoffice_data_path)
    normalized_noaa_data_path = normalize_noaa(noaa_data_path)

    merge_climate_data(
        normalized_bom_data_path,
        normalized_ecmwf_data_path,
        normalized_jma_data_path,
        normalized_metoffice_data_path,
        normalized_noaa_data_path,
    )

# Schedule
@schedule(
    job=download_noaa_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="download_noaa_pipeline_schedule",
    description="Daily schedule for the download_noaa_pipeline job.",
    execution_time=datetime.time(hour=0, minute=0),
    should_execute=lambda: True,
    tags={"dagster/schedule_name": "download_noaa_pipeline_schedule"},
    execution_timezone="UTC",
    catchup=False,
)
def download_noaa_pipeline_schedule(_context):
    return {}