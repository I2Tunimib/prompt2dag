# Generated by Dagster Code Generator
# Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    In,
    Out,
    RetryPolicy,
    fs_io_manager,
    multiprocess_executor,
    schedule,
)

# Define the resources
us_east_data_source = fs_io_manager.configured({"base_dir": "/path/to/us_east_data"})
us_west_data_source = fs_io_manager.configured({"base_dir": "/path/to/us_west_data"})
eu_data_source = fs_io_manager.configured({"base_dir": "/path/to/eu_data"})
apac_data_source = fs_io_manager.configured({"base_dir": "/path/to/apac_data"})
xcom = None  # Placeholder for XCom resource

# Define the ops
@op(
    name="start_pipeline",
    description="Start Pipeline",
    retry_policy=RetryPolicy(max_retries=0),
)
def start_pipeline(context):
    """Start the pipeline."""
    context.log.info("Pipeline started.")
    return "Pipeline started"

@op(
    name="ingest_apac",
    description="Ingest APAC Sales Data",
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"apac_data_source"},
)
def ingest_apac(context):
    """Ingest APAC sales data."""
    context.log.info("Ingesting APAC sales data.")
    # Simulate data ingestion
    return "APAC data ingested"

@op(
    name="ingest_eu",
    description="Ingest EU Sales Data",
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"eu_data_source"},
)
def ingest_eu(context):
    """Ingest EU sales data."""
    context.log.info("Ingesting EU sales data.")
    # Simulate data ingestion
    return "EU data ingested"

@op(
    name="ingest_us_east",
    description="Ingest US-East Sales Data",
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"us_east_data_source"},
)
def ingest_us_east(context):
    """Ingest US-East sales data."""
    context.log.info("Ingesting US-East sales data.")
    # Simulate data ingestion
    return "US-East data ingested"

@op(
    name="ingest_us_west",
    description="Ingest US-West Sales Data",
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"us_west_data_source"},
)
def ingest_us_west(context):
    """Ingest US-West sales data."""
    context.log.info("Ingesting US-West sales data.")
    # Simulate data ingestion
    return "US-West data ingested"

@op(
    name="convert_currency_apac",
    description="Convert APAC Currency to USD",
    retry_policy=RetryPolicy(max_retries=2),
)
def convert_currency_apac(context, apac_data):
    """Convert APAC currency to USD."""
    context.log.info("Converting APAC currency to USD.")
    # Simulate currency conversion
    return "APAC currency converted to USD"

@op(
    name="convert_currency_eu",
    description="Convert EU Currency to USD",
    retry_policy=RetryPolicy(max_retries=2),
)
def convert_currency_eu(context, eu_data):
    """Convert EU currency to USD."""
    context.log.info("Converting EU currency to USD.")
    # Simulate currency conversion
    return "EU currency converted to USD"

@op(
    name="convert_currency_us_east",
    description="Convert US-East Currency to USD",
    retry_policy=RetryPolicy(max_retries=2),
)
def convert_currency_us_east(context, us_east_data):
    """Convert US-East currency to USD."""
    context.log.info("Converting US-East currency to USD.")
    # Simulate currency conversion
    return "US-East currency converted to USD"

@op(
    name="convert_currency_us_west",
    description="Convert US-West Currency to USD",
    retry_policy=RetryPolicy(max_retries=2),
)
def convert_currency_us_west(context, us_west_data):
    """Convert US-West currency to USD."""
    context.log.info("Converting US-West currency to USD.")
    # Simulate currency conversion
    return "US-West currency converted to USD"

@op(
    name="aggregate_global_revenue",
    description="Aggregate Global Revenue",
    retry_policy=RetryPolicy(max_retries=2),
)
def aggregate_global_revenue(context, us_east_data, us_west_data, eu_data, apac_data):
    """Aggregate global revenue."""
    context.log.info("Aggregating global revenue.")
    # Simulate revenue aggregation
    return "Global revenue aggregated"

@op(
    name="end_pipeline",
    description="End Pipeline",
    retry_policy=RetryPolicy(max_retries=0),
)
def end_pipeline(context, aggregated_revenue):
    """End the pipeline."""
    context.log.info("Pipeline ended.")
    return "Pipeline ended"

# Define the job
@job(
    name="start_pipeline_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "us_east_data_source": us_east_data_source,
        "us_west_data_source": us_west_data_source,
        "eu_data_source": eu_data_source,
        "apac_data_source": apac_data_source,
        "xcom": xcom,
    },
)
def start_pipeline_pipeline():
    start = start_pipeline()
    ingest_us_east_data = ingest_us_east(start)
    ingest_us_west_data = ingest_us_west(start)
    ingest_eu_data = ingest_eu(start)
    ingest_apac_data = ingest_apac(start)
    
    convert_us_east = convert_currency_us_east(ingest_us_east_data)
    convert_us_west = convert_currency_us_west(ingest_us_west_data)
    convert_eu = convert_currency_eu(ingest_eu_data)
    convert_apac = convert_currency_apac(ingest_apac_data)
    
    aggregate = aggregate_global_revenue(
        convert_us_east, convert_us_west, convert_eu, convert_apac
    )
    end_pipeline(aggregate)

# Define the schedule
@schedule(
    job=start_pipeline_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="start_pipeline_pipeline_schedule",
    catchup=False,
)
def start_pipeline_pipeline_schedule(_context):
    return {}