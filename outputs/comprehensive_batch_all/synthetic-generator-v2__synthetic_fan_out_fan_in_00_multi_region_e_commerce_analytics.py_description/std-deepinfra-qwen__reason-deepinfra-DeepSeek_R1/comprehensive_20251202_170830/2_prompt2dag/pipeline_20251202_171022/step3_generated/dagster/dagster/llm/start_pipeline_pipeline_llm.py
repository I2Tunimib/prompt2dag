# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: start_pipeline_pipeline
# - Description: Comprehensive Pipeline Description: This pipeline performs multi-region ecommerce analytics by ingesting sales data from four geographic regions in parallel, converting regional currencies to USD, and aggregating the results into a global revenue report.
# - Executor Type: multiprocess_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: []

import dagster
from dagster import job, op, In, Out, RetryPolicy, fs_io_manager, multiprocess_executor

# Define the start pipeline op
@op
def start_pipeline(context):
    """Start the pipeline."""
    context.log.info("Pipeline started")
    return "Pipeline started"

# Define the ingest ops
@op(retry_policy=RetryPolicy(max_retries=2))
def ingest_apac(context):
    """Ingest APAC Sales Data."""
    context.log.info("Ingesting APAC sales data")
    return "APAC data ingested"

@op(retry_policy=RetryPolicy(max_retries=2))
def ingest_eu(context):
    """Ingest EU Sales Data."""
    context.log.info("Ingesting EU sales data")
    return "EU data ingested"

@op(retry_policy=RetryPolicy(max_retries=2))
def ingest_us_east(context):
    """Ingest US-East Sales Data."""
    context.log.info("Ingesting US-East sales data")
    return "US-East data ingested"

@op(retry_policy=RetryPolicy(max_retries=2))
def ingest_us_west(context):
    """Ingest US-West Sales Data."""
    context.log.info("Ingesting US-West sales data")
    return "US-West data ingested"

# Define the currency conversion ops
@op(retry_policy=RetryPolicy(max_retries=2))
def convert_currency_apac(context, apac_data):
    """Convert APAC Currency to USD."""
    context.log.info("Converting APAC currency to USD")
    return "APAC currency converted to USD"

@op(retry_policy=RetryPolicy(max_retries=2))
def convert_currency_eu(context, eu_data):
    """Convert EU Currency to USD."""
    context.log.info("Converting EU currency to USD")
    return "EU currency converted to USD"

@op(retry_policy=RetryPolicy(max_retries=2))
def convert_currency_us_east(context, us_east_data):
    """Convert US-East Currency to USD."""
    context.log.info("Converting US-East currency to USD")
    return "US-East currency converted to USD"

@op(retry_policy=RetryPolicy(max_retries=2))
def convert_currency_us_west(context, us_west_data):
    """Convert US-West Currency to USD."""
    context.log.info("Converting US-West currency to USD")
    return "US-West currency converted to USD"

# Define the aggregate global revenue op
@op(retry_policy=RetryPolicy(max_retries=2))
def aggregate_global_revenue(context, us_east_converted, us_west_converted, eu_converted, apac_converted):
    """Aggregate Global Revenue."""
    context.log.info("Aggregating global revenue")
    return "Global revenue aggregated"

# Define the end pipeline op
@op
def end_pipeline(context, aggregated_revenue):
    """End the pipeline."""
    context.log.info("Pipeline ended")
    return "Pipeline ended"

# Define the job
@job(
    name="start_pipeline_pipeline",
    description="Comprehensive Pipeline Description: This pipeline performs multi-region ecommerce analytics by ingesting sales data from four geographic regions in parallel, converting regional currencies to USD, and aggregating the results into a global revenue report.",
    executor_def=multiprocess_executor,
    resource_defs={"io_manager": fs_io_manager}
)
def start_pipeline_pipeline():
    start = start_pipeline()
    
    us_east_data = ingest_us_east(start)
    us_west_data = ingest_us_west(start)
    eu_data = ingest_eu(start)
    apac_data = ingest_apac(start)
    
    us_east_converted = convert_currency_us_east(us_east_data)
    us_west_converted = convert_currency_us_west(us_west_data)
    eu_converted = convert_currency_eu(eu_data)
    apac_converted = convert_currency_apac(apac_data)
    
    aggregated_revenue = aggregate_global_revenue(us_east_converted, us_west_converted, eu_converted, apac_converted)
    
    end_pipeline(aggregated_revenue)

# Define the schedule
@dagster.schedule(
    job=start_pipeline_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="start_pipeline_pipeline_schedule",
    catchup=False
)
def start_pipeline_pipeline_schedule(_context):
    return {}