# Generated by Dagster Code Generator
# Date: 2023-10-05
# Dagster Version: 1.5.0

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    schedule,
)

# Resources
@resource
def email_delivery_system():
    """Email Delivery System resource."""
    pass

@resource
def sms_gateway():
    """SMS Gateway resource."""
    pass

@resource
def push_notification_service():
    """Push Notification Service resource."""
    pass

@resource
def local_filesystem():
    """Local File System resource."""
    pass

# Ops
@op(
    out={"customer_segment_data": Out()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"local_filesystem"},
)
def load_customer_segment_csv(context):
    """Load Customer Segment CSV."""
    # Simulate loading data from a CSV file
    customer_segment_data = {"data": "sample_data"}
    context.log.info("Loaded customer segment data")
    return customer_segment_data

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"email_delivery_system"},
)
def send_email_campaign(context, customer_segment_data):
    """Send Email Campaign."""
    context.log.info("Sending email campaign to customer segments")
    # Simulate sending emails
    context.resources.email_delivery_system.send_email(customer_segment_data)

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"sms_gateway"},
)
def send_sms_campaign(context, customer_segment_data):
    """Send SMS Campaign."""
    context.log.info("Sending SMS campaign to customer segments")
    # Simulate sending SMS
    context.resources.sms_gateway.send_sms(customer_segment_data)

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"push_notification_service"},
)
def send_push_notification(context, customer_segment_data):
    """Send Push Notification."""
    context.log.info("Sending push notification to customer segments")
    # Simulate sending push notifications
    context.resources.push_notification_service.send_push_notification(customer_segment_data)

# Job
@job(
    name="load_customer_segment_csv_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "email_delivery_system": email_delivery_system,
        "sms_gateway": sms_gateway,
        "push_notification_service": push_notification_service,
        "local_filesystem": local_filesystem,
        "io_manager": fs_io_manager,
    },
)
def load_customer_segment_csv_pipeline():
    """Load customer segment CSV and send campaigns."""
    customer_segment_data = load_customer_segment_csv()
    send_email_campaign(customer_segment_data)
    send_sms_campaign(customer_segment_data)
    send_push_notification(customer_segment_data)

# Schedule
@schedule(
    job=load_customer_segment_csv_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="load_customer_segment_csv_pipeline_schedule",
    catchup=False,
)
def load_customer_segment_csv_pipeline_schedule(_context):
    return {}