# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: load_customer_segment_csv_pipeline
# - Description: No description provided.
# - Executor Type: multiprocess_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: sms_delivery_gateway, push_notification_service, local_filesystem, email_delivery_system

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    schedule,
)

@resource
def local_filesystem(context):
    """Local File System resource."""
    pass

@resource
def email_delivery_system(context):
    """Email Delivery System resource."""
    pass

@resource
def sms_delivery_gateway(context):
    """SMS Gateway resource."""
    pass

@resource
def push_notification_service(context):
    """Push Notification Service resource."""
    pass

@op(
    out={"customer_segment_data": Out()},
    required_resource_keys={"local_filesystem"},
    retry_policy=RetryPolicy(max_retries=2),
)
def load_customer_segment_csv(context):
    """Load Customer Segment CSV."""
    # Simulate loading customer segment data from a CSV file
    customer_segment_data = "sample_data"
    context.log.info(f"Loaded customer segment data: {customer_segment_data}")
    return customer_segment_data

@op(
    in_={"customer_segment_data": In()},
    required_resource_keys={"email_delivery_system"},
    retry_policy=RetryPolicy(max_retries=2),
)
def send_email_campaign(context, customer_segment_data):
    """Send Email Campaign."""
    # Simulate sending an email campaign
    context.log.info(f"Sending email campaign to customer segment: {customer_segment_data}")

@op(
    in_={"customer_segment_data": In()},
    required_resource_keys={"sms_delivery_gateway"},
    retry_policy=RetryPolicy(max_retries=2),
)
def send_sms_campaign(context, customer_segment_data):
    """Send SMS Campaign."""
    # Simulate sending an SMS campaign
    context.log.info(f"Sending SMS campaign to customer segment: {customer_segment_data}")

@op(
    in_={"customer_segment_data": In()},
    required_resource_keys={"push_notification_service"},
    retry_policy=RetryPolicy(max_retries=2),
)
def send_push_notification(context, customer_segment_data):
    """Send Push Notification."""
    # Simulate sending a push notification
    context.log.info(f"Sending push notification to customer segment: {customer_segment_data}")

@job(
    name="load_customer_segment_csv_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "local_filesystem": local_filesystem,
        "email_delivery_system": email_delivery_system,
        "sms_delivery_gateway": sms_delivery_gateway,
        "push_notification_service": push_notification_service,
    },
    io_manager_def=fs_io_manager,
)
def load_customer_segment_csv_pipeline():
    """Dagster job to load customer segment CSV and send campaigns."""
    customer_segment_data = load_customer_segment_csv()
    send_email_campaign(customer_segment_data)
    send_sms_campaign(customer_segment_data)
    send_push_notification(customer_segment_data)

@schedule(
    job=load_customer_segment_csv_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    name="load_customer_segment_csv_pipeline_schedule",
    catchup=False,
)
def load_customer_segment_csv_pipeline_schedule(_context):
    return {}