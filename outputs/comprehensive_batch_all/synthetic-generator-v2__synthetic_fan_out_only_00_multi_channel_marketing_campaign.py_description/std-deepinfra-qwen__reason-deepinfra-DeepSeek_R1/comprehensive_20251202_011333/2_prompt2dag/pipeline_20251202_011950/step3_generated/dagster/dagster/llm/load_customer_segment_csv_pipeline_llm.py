# Generated by Dagster Code Generator
# Generation Metadata:
# - Job Name: load_customer_segment_csv_pipeline
# - Description: No description provided.
# - Executor Type: multiprocess_executor
# - IO Manager: fs_io_manager
# - Dagster Version: 1.5.0
# - Use Assets: False
# - Required Resources: mobile_push_notification_service, sms_delivery_gateway, email_delivery_system, local_filesystem

from dagster import (
    job,
    op,
    Out,
    In,
    RetryPolicy,
    multiprocess_executor,
    fs_io_manager,
    resource,
    ScheduleDefinition,
    ScheduleEvaluationContext,
)

# Define resources
@resource
def email_delivery_system():
    """Email Delivery System resource."""
    pass

@resource
def sms_gateway():
    """SMS Gateway resource."""
    pass

@resource
def push_notification_service():
    """Push Notification Service resource."""
    pass

@resource
def local_filesystem():
    """Local File System resource."""
    pass

# Define ops
@op(
    out={"customer_segment_data": Out()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"local_filesystem"},
)
def load_customer_segment_csv(context):
    """Load Customer Segment CSV."""
    # Simulate loading data from a CSV file
    customer_segment_data = [
        {"customer_id": 1, "segment": "A"},
        {"customer_id": 2, "segment": "B"},
        {"customer_id": 3, "segment": "C"},
    ]
    context.log.info("Loaded customer segment data from CSV.")
    return customer_segment_data

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"email_delivery_system"},
)
def send_email_campaign(context, customer_segment_data):
    """Send Email Campaign."""
    # Simulate sending email campaign
    for customer in customer_segment_data:
        context.log.info(f"Sending email to customer {customer['customer_id']} in segment {customer['segment']}")
    context.log.info("Email campaign sent successfully.")

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"push_notification_service"},
)
def send_push_notification(context, customer_segment_data):
    """Send Push Notification."""
    # Simulate sending push notifications
    for customer in customer_segment_data:
        context.log.info(f"Sending push notification to customer {customer['customer_id']} in segment {customer['segment']}")
    context.log.info("Push notifications sent successfully.")

@op(
    in_={"customer_segment_data": In()},
    retry_policy=RetryPolicy(max_retries=2),
    required_resource_keys={"sms_gateway"},
)
def send_sms_campaign(context, customer_segment_data):
    """Send SMS Campaign."""
    # Simulate sending SMS campaign
    for customer in customer_segment_data:
        context.log.info(f"Sending SMS to customer {customer['customer_id']} in segment {customer['segment']}")
    context.log.info("SMS campaign sent successfully.")

# Define job
@job(
    name="load_customer_segment_csv_pipeline",
    description="No description provided.",
    executor_def=multiprocess_executor,
    resource_defs={
        "email_delivery_system": email_delivery_system,
        "sms_gateway": sms_gateway,
        "push_notification_service": push_notification_service,
        "local_filesystem": local_filesystem,
    },
    io_manager_def=fs_io_manager,
)
def load_customer_segment_csv_pipeline():
    """Load customer segment CSV and send campaigns."""
    customer_segment_data = load_customer_segment_csv()
    send_email_campaign(customer_segment_data)
    send_push_notification(customer_segment_data)
    send_sms_campaign(customer_segment_data)

# Define schedule
load_customer_segment_csv_pipeline_schedule = ScheduleDefinition(
    job=load_customer_segment_csv_pipeline,
    cron_schedule="@daily",
    execution_timezone="UTC",
    should_execute=lambda _context: True,
    execution_fn=lambda _context: {},
    name="load_customer_segment_csv_pipeline_schedule",
    description="Daily schedule for the load_customer_segment_csv_pipeline.",
)