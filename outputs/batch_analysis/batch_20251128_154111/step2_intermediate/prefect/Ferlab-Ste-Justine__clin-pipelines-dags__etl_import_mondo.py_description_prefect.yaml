metadata:
  target_orchestrator: prefect
  generated_at: 2025-11-28 15:43:09.975076
  source_analysis_file: 
    Pipeline_Description_Dataset/Ferlab-Ste-Justine__clin-pipelines-dags__etl_import_mondo.py_description.txt
  pipeline_name: etl_import_mondo
  pipeline_description: Comprehensive ETL pipeline for importing Mondo ontology data that downloads the Mondo OBO file 
    from GitHub releases, normalizes terms using Spark processing, indexes the data to Elasticsearch, publishes results,
    and sends a Slack notification upon completion.
  orchestrator_specific:
    flow_name: etl_import_mondo
    deployment_name: etl_import_mondo_deployment
    work_pool: default-agent-pool
    task_runner: SequentialTaskRunner
    prefect_version: 2.14.0
schedule:
  enabled: false
  schedule_expression:
  start_date: '2022-01-01T00:00:00'
  end_date:
  timezone: UTC
  catchup: false
connections:
  - conn_id: github_mondo_releases
    conn_type: Secret
    description: GitHub Mondo Releases
    config:
      block_type: Secret
      block_module: prefect.blocks.system
      block_name: github_mondo_releases
      config:
        base_url: https://github.com/monarch-initiative/mondo/releases
        host:
        port:
        protocol: https
        database:
        schema:
        bucket:
        queue_name:
  - conn_id: s3_datalake
    conn_type: S3Bucket
    description: S3 Data Lake
    config:
      block_type: S3Bucket
      block_module: prefect_aws.s3
      block_name: s3_datalake
      config:
        base_path:
        base_url:
        host:
        port:
        protocol: s3
        database:
        schema:
        bucket: cqgc-{env}-app-datalake
        queue_name:
  - conn_id: elasticsearch_cluster
    conn_type: Secret
    description: Elasticsearch Cluster
    config:
      block_type: Secret
      block_module: prefect.blocks.system
      block_name: elasticsearch_cluster
      config:
        base_path:
        base_url:
        host:
        port:
        protocol: https
        database:
        schema:
        bucket:
        queue_name:
        token_secret_name: ES_TOKEN
  - conn_id: slack_webhook
    conn_type: Secret
    description: Slack Webhook
    config:
      block_type: Secret
      block_module: prefect.blocks.system
      block_name: slack_webhook
      config:
        base_url: https://hooks.slack.com
        host:
        port:
        protocol: https
        database:
        schema:
        bucket:
        queue_name:
        token_secret_name: SLACK_WEBHOOK_TOKEN
tasks:
  - task_id: validate_color_params
    task_name: Validate Color Parameters
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: validate_color_params
    config:
      task_decorator: '@task'
      infrastructure:
        type: Process
        module: prefect.infrastructure.process
        config:
          fn: validate_color
      retries: 0
    upstream_task_ids: []
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
  - task_id: download_mondo_obo
    task_name: Download Mondo OBO File
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: download_mondo_obo
    config:
      task_decorator: '@task'
      infrastructure:
        type: Process
        module: prefect.infrastructure.process
        config:
          fn: download
      retries: 0
    upstream_task_ids:
      - validate_color_params
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
  - task_id: normalize_mondo_terms
    task_name: Normalize Mondo Terms
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: normalize_mondo_terms
    config:
      task_decorator: '@task'
      infrastructure:
        config: {}
      retries: 0
      task_runner: ConcurrentTaskRunner
    upstream_task_ids:
      - download_mondo_obo
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
  - task_id: index_mondo_terms
    task_name: Index Mondo Terms to Elasticsearch
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: index_mondo_terms
    config:
      task_decorator: '@task'
      infrastructure:
        config: {}
      retries: 0
      task_runner: ConcurrentTaskRunner
    upstream_task_ids:
      - normalize_mondo_terms
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
  - task_id: publish_mondo_data
    task_name: Publish Mondo Data
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: publish_mondo_data
    config:
      task_decorator: '@task'
      infrastructure:
        type: Process
        module: prefect.infrastructure.process
        config:
          fn: publish_index.mondo
      retries: 0
    upstream_task_ids:
      - index_mondo_terms
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
  - task_id: send_slack_notification
    task_name: Send Slack Notification
    operator_class: Process
    operator_module: prefect.infrastructure.process
    component_ref: send_slack_notification
    config:
      task_decorator: '@task'
      infrastructure:
        type: Process
        module: prefect.infrastructure.process
        config:
          fn: Slack.notify_dag_completion
      retries: 0
    upstream_task_ids:
      - publish_mondo_data
    trigger_rule: wait_for='all'
    retries: 0
    retry_delay_seconds: 0
    validation_warnings: []
